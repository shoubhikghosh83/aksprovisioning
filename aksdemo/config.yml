apiVersion: v1
kind: Namespace
metadata:
 name: #{Release.EnvironmentName}#
 ---
apiVersion: apps/v1beta1
kind: Deployment
metadata:
 name: service
 namespace: #{Release.EnvironmentName}#
spec:
replicas: #{Release.Service.Replicas}#
template:
 metadata:
  labels:
   app: service
 spec:
  containers:
  - image: aksdemoconreg.azurecr.io/service:#{Release.Artifacts.Service}#
    name: service
    ports:
    - containerPort: 8080
    imagePullSecrets:
    - name: acrsecret
---
apiVersion: v1
kind: Service
metadata:
 name: service
 namespace: #{Release.EnvironmentName}#
spec:
 ports:
 - port: 80
   protocol: TCP
   targetPort: 8080
 selector:
   app: service
 type: ClusterIP
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
 name: service
 annotations:
  kubernetes.io/ingress.class: addon-http-application-routing
spec:
 rules:
 - host: service.405bb2c6ff9540e2b186.westeurope.aksapp.io
   http:
    paths:
    - backend:
       serviceName: service
       servicePort: 80
      path: /
  
  
 
 
  
